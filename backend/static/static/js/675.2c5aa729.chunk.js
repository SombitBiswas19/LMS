"use strict";(self.webpackChunklearnalytics_frontend=self.webpackChunklearnalytics_frontend||[]).push([[675],{8675:(e,s,l)=>{l.r(s),l.d(s,{default:()=>E});var t=l(5043),a=l(3216),i=l(108),r=l(2291),o=l(7734),n=l(2185),d=l(6026),c=l(6150),u=l(1327),x=l(8643),h=l(163),m=l(4240),g=l(7869),v=l(5748),j=l(168),p=l(5275),y=l(4068),b=l(9445),f=l(8112),w=l(5300),N=l(2543),_=l(4082),A=l(3458),k=l(9621),C=l(3768),S=l(579);const K=["#0088FE","#00C49F","#FFBB28","#FF8042"],q=e=>{var s,l,t,a,y;let{data:b,courseAnalytics:_}=e;const A=_.map(e=>({name:e.course_title.substring(0,20)+"...",enrollments:e.total_enrollments,completion:e.completion_rate,avgScore:e.avg_quiz_score})),k=[{name:"Low Risk",value:(null===b||void 0===b||null===(s=b.student_performance)||void 0===s?void 0:s.filter(e=>e.avg_quiz_score>70).length)||0},{name:"Medium Risk",value:(null===b||void 0===b||null===(l=b.student_performance)||void 0===l?void 0:l.filter(e=>e.avg_quiz_score>=50&&e.avg_quiz_score<=70).length)||0},{name:"High Risk",value:(null===b||void 0===b||null===(t=b.student_performance)||void 0===t?void 0:t.filter(e=>e.avg_quiz_score<50).length)||0}],C=(null===b||void 0===b||null===(a=b.student_performance)||void 0===a?void 0:a.map(e=>({name:e.student_name.split(" ")[0],watchTime:e.total_watch_time,score:e.avg_quiz_score})))||[];return(0,S.jsxs)("div",{className:"space-y-8",children:[(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,S.jsx)(D,{title:"Total Students",value:(null===b||void 0===b?void 0:b.total_students)||0,icon:f.A,color:"blue"}),(0,S.jsx)(D,{title:"Active Courses",value:(null===b||void 0===b?void 0:b.total_courses)||0,icon:w.A,color:"green"}),(0,S.jsx)(D,{title:"Total Enrollments",value:(null===b||void 0===b?void 0:b.total_enrollments)||0,icon:p.A,color:"purple"}),(0,S.jsx)(D,{title:"At-Risk Students",value:(null===b||void 0===b||null===(y=b.dropout_alerts)||void 0===y?void 0:y.length)||0,icon:N.A,color:"red"})]}),(0,S.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Course Performance"}),(0,S.jsx)(i.u,{width:"100%",height:300,children:(0,S.jsxs)(r.E,{data:A,children:[(0,S.jsx)(o.d,{strokeDasharray:"3 3"}),(0,S.jsx)(n.W,{dataKey:"name"}),(0,S.jsx)(d.h,{}),(0,S.jsx)(c.m,{}),(0,S.jsx)(u.s,{}),(0,S.jsx)(x.y,{dataKey:"enrollments",fill:"#3b82f6"}),(0,S.jsx)(x.y,{dataKey:"completion",fill:"#10b981"})]})})]}),(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Student Risk Distribution"}),(0,S.jsx)(i.u,{width:"100%",height:300,children:(0,S.jsxs)(h.r,{children:[(0,S.jsx)(m.F,{data:k,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,value:l}=e;return`${s}: ${l}`},outerRadius:80,fill:"#8884d8",dataKey:"value",children:k.map((e,s)=>(0,S.jsx)(g.f,{fill:K[s%K.length]},`cell-${s}`))}),(0,S.jsx)(c.m,{})]})})]})]}),(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Student Engagement vs Performance"}),(0,S.jsx)(i.u,{width:"100%",height:300,children:(0,S.jsxs)(v.b,{data:C,children:[(0,S.jsx)(o.d,{strokeDasharray:"3 3"}),(0,S.jsx)(n.W,{dataKey:"name"}),(0,S.jsx)(d.h,{yAxisId:"left"}),(0,S.jsx)(d.h,{yAxisId:"right",orientation:"right"}),(0,S.jsx)(c.m,{}),(0,S.jsx)(u.s,{}),(0,S.jsx)(x.y,{yAxisId:"left",dataKey:"watchTime",fill:"#8884d8"}),(0,S.jsx)(j.N,{yAxisId:"right",type:"monotone",dataKey:"score",stroke:"#ff7300"})]})})]})]})},z=e=>{var s;let{data:l}=e;const t=(null===l||void 0===l||null===(s=l.current_courses)||void 0===s?void 0:s.map(e=>({name:e.title.substring(0,20)+"...",progress:e.progress})))||[];return(0,S.jsxs)("div",{className:"space-y-8",children:[(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,S.jsx)(D,{title:"Enrolled Courses",value:(null===l||void 0===l?void 0:l.total_enrollments)||0,icon:w.A,color:"blue"}),(0,S.jsx)(D,{title:"Completed",value:(null===l||void 0===l?void 0:l.completed_courses)||0,icon:_.A,color:"green"}),(0,S.jsx)(D,{title:"Watch Time",value:`${Math.round((null===l||void 0===l?void 0:l.total_watch_time)||0)}h`,icon:A.A,color:"purple"}),(0,S.jsx)(D,{title:"Avg Score",value:`${Math.round((null===l||void 0===l?void 0:l.avg_quiz_score)||0)}%`,icon:p.A,color:"yellow"})]}),(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Course Progress"}),(0,S.jsx)(i.u,{width:"100%",height:300,children:(0,S.jsxs)(r.E,{data:t,children:[(0,S.jsx)(o.d,{strokeDasharray:"3 3"}),(0,S.jsx)(n.W,{dataKey:"name"}),(0,S.jsx)(d.h,{}),(0,S.jsx)(c.m,{}),(0,S.jsx)(x.y,{dataKey:"progress",fill:"#3b82f6"})]})})]})]})},D=e=>{let{title:s,value:l,icon:t,color:a}=e;return(0,S.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 flex items-center justify-between",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-sm text-gray-500",children:s}),(0,S.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:l})]}),(0,S.jsx)("div",{className:`p-3 rounded-full ${{blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",purple:"bg-purple-50 text-purple-600",yellow:"bg-yellow-50 text-yellow-600",red:"bg-red-50 text-red-600"}[a]}`,children:(0,S.jsx)(t,{className:"h-6 w-6"})})]})},E=e=>{let{user:s,onLogout:l}=e;const[i,r]=(0,t.useState)(null),[o,n]=(0,t.useState)([]),[d,c]=(0,t.useState)(!0),[u,x]=(0,t.useState)(!1),h=(0,a.Zp)();(0,t.useEffect)(()=>{m()},[]);const m=async()=>{try{if("admin"===(null===s||void 0===s?void 0:s.role)){const[e,s]=await Promise.all([k.rh.getAdminDashboard(),k.GS.getCourses()]);r(e);const l=s.slice(0,5).map(e=>k.rh.getCourseAnalytics(e.id).catch(()=>null)),t=await Promise.all(l);n(t.filter(Boolean))}else{const e=await k.rh.getStudentDashboard();r(e)}}catch(e){(0,k.hS)(e)}finally{c(!1)}},g=async()=>{x(!0),await m(),x(!1),C.Ay.success("Analytics refreshed!")};return d?(0,S.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,S.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,S.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,S.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,S.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,S.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(p.A,{className:"h-8 w-8 text-blue-600 mr-3"}),(0,S.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics"})]}),(0,S.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,S.jsx)("button",{onClick:()=>h("/dashboard"),className:"text-gray-600 hover:text-gray-900 transition-colors",children:"Dashboard"}),(0,S.jsx)("button",{onClick:g,disabled:u,className:"p-2 text-gray-500 hover:text-gray-700 transition-colors disabled:opacity-50",children:(0,S.jsx)(y.A,{className:"h-5 w-5 "+(u?"animate-spin":"")})}),(0,S.jsx)("span",{className:"text-sm text-gray-700",children:null===s||void 0===s?void 0:s.full_name}),(0,S.jsx)("button",{onClick:l,className:"p-2 text-gray-500 hover:text-gray-700 transition-colors",children:(0,S.jsx)(b.A,{className:"h-5 w-5"})})]})]})})}),(0,S.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:"admin"===(null===s||void 0===s?void 0:s.role)?(0,S.jsx)(q,{data:i,courseAnalytics:o,onRefresh:g}):(0,S.jsx)(z,{data:i})})]})}}}]);
//# sourceMappingURL=675.2c5aa729.chunk.js.map