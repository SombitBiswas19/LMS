"use strict";(self.webpackChunklearnalytics_frontend=self.webpackChunklearnalytics_frontend||[]).push([[917],{7917:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var l=t(5043),a=t(3216),r=t(1043),n=t.n(r),c=t(9621),i=(t(3768),t(7607)),o=t(1620),d=t(1701),x=t(74),h=t(1037),u=t(2431),m=t(6514),g=t(2726),b=t(3458),f=t(917),j=t(579);const N=e=>{let{user:s,onLogout:t}=e;const{courseId:r,lessonId:N}=(0,a.g)(),p=(0,a.Zp)(),[v,w]=(0,l.useState)(null),[y,k]=(0,l.useState)([]),[C,S]=(0,l.useState)(null),[A,$]=(0,l.useState)(!1),[E,I]=(0,l.useState)(.8),[F,_]=(0,l.useState)(!1),[M,P]=(0,l.useState)(0),[L,G]=(0,l.useState)(0),[R,T]=(0,l.useState)(!0),[q,B]=(0,l.useState)(0),[D,Z]=(0,l.useState)(!0),z=(0,l.useRef)(null),H=(0,l.useRef)(0);(0,l.useEffect)(()=>{J()},[r]),(0,l.useEffect)(()=>{if(y.length>0&&N){const e=y.find(e=>e.id===parseInt(N));S(e)}},[y,N]),(0,l.useEffect)(()=>{const e=setInterval(()=>{A&&C&&(H.current+=1,B(e=>e+1))},1e3);return()=>clearInterval(e)},[A,C]),(0,l.useEffect)(()=>()=>{C&&H.current>0&&K()},[C]);const J=async()=>{try{const[e,s]=await Promise.all([c.GS.getCourse(r),c.GS.getLessons(r)]);w(e),k(s)}catch(e){(0,c.hS)(e)}finally{Z(!1)}},K=async()=>{if(C&&0!==H.current)try{await c.rh.updateProgress(parseInt(r),C.id,H.current/60,M>.9),H.current=0}catch(e){console.error("Failed to update progress:",e)}},O=()=>y.findIndex(e=>e.id===(null===C||void 0===C?void 0:C.id)),Q=()=>{const e=O();if(e<y.length-1){const s=y[e+1];p(`/course/${r}/lesson/${s.id}`)}},U=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return D?(0,j.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,j.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):C?(0,j.jsx)("div",{className:"min-h-screen bg-black",children:(0,j.jsxs)("div",{className:"flex h-screen",children:[(0,j.jsxs)("div",{className:"flex-1 flex flex-col "+(R?"w-3/4":"w-full"),children:[(0,j.jsxs)("div",{className:"bg-gray-900 text-white p-4 flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,j.jsx)("button",{onClick:()=>p("/courses"),className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:(0,j.jsx)(i.A,{className:"h-5 w-5"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h1",{className:"text-lg font-semibold",children:C.title}),(0,j.jsx)("p",{className:"text-sm text-gray-300",children:v.title})]})]}),(0,j.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,j.jsx)("button",{onClick:()=>T(!R),className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:(0,j.jsx)(o.A,{className:"h-5 w-5"})}),(0,j.jsxs)("span",{className:"text-sm text-gray-300",children:[U(q)," watched"]})]})]}),(0,j.jsxs)("div",{className:"flex-1 relative bg-black",children:[C.video_url?(0,j.jsx)(n(),{ref:z,url:`http://localhost:8000${C.video_url}`,width:"100%",height:"100%",playing:A,volume:E,muted:F,onProgress:e=>{P(e.played)},onDuration:e=>{G(e)},onEnded:()=>{$(!1),K(),O()<y.length-1&&setTimeout(Q,2e3)}}):(0,j.jsx)("div",{className:"w-full h-full flex items-center justify-center text-white",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)(d.A,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),(0,j.jsx)("p",{className:"text-lg",children:"No video available for this lesson"})]})}),(0,j.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-4",children:(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{className:"flex items-center space-x-2 text-white text-sm",children:[(0,j.jsx)("span",{children:U(M*L)}),(0,j.jsx)("div",{className:"flex-1",children:(0,j.jsx)("input",{type:"range",min:0,max:1,step:.01,value:M,onChange:e=>(e=>{var s;null===(s=z.current)||void 0===s||s.seekTo(e),P(e)})(parseFloat(e.target.value)),className:"w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${100*M}%, #4b5563 ${100*M}%, #4b5563 100%)`}})}),(0,j.jsx)("span",{children:U(L)})]}),(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,j.jsx)("button",{onClick:()=>$(!A),className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",children:A?(0,j.jsx)(x.A,{className:"h-6 w-6 text-white"}):(0,j.jsx)(d.A,{className:"h-6 w-6 text-white"})}),(0,j.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,j.jsx)("button",{onClick:()=>_(!F),className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",children:F?(0,j.jsx)(h.A,{className:"h-5 w-5 text-white"}):(0,j.jsx)(u.A,{className:"h-5 w-5 text-white"})}),(0,j.jsx)("input",{type:"range",min:0,max:1,step:.1,value:E,onChange:e=>I(parseFloat(e.target.value)),className:"w-20 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]})]}),(0,j.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,j.jsx)("button",{onClick:()=>{const e=O();if(e>0){const s=y[e-1];p(`/course/${r}/lesson/${s.id}`)}},disabled:0===O(),className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,j.jsx)(i.A,{className:"h-5 w-5 text-white"})}),(0,j.jsx)("button",{onClick:Q,disabled:O()===y.length-1,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,j.jsx)(m.A,{className:"h-5 w-5 text-white"})}),(0,j.jsx)("button",{onClick:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()},className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",children:(0,j.jsx)(g.A,{className:"h-5 w-5 text-white"})})]})]})]})})]})]}),R&&(0,j.jsxs)("div",{className:"w-1/4 bg-white border-l border-gray-200 flex flex-col",children:[(0,j.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,j.jsx)("h3",{className:"font-semibold text-gray-900",children:"Course Content"}),(0,j.jsxs)("p",{className:"text-sm text-gray-600",children:[y.length," lessons"]})]}),(0,j.jsx)("div",{className:"flex-1 overflow-y-auto",children:y.map((e,s)=>(0,j.jsx)("button",{onClick:()=>{K(),p(`/course/${r}/lesson/${e.id}`)},className:"w-full p-4 text-left border-b border-gray-100 hover:bg-gray-50 transition-colors "+(C.id===e.id?"bg-blue-50 border-l-4 border-l-blue-600":""),children:(0,j.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,j.jsx)("div",{className:"flex-shrink-0 mt-1",children:C.id===e.id?A?(0,j.jsx)(x.A,{className:"h-4 w-4 text-blue-600"}):(0,j.jsx)(d.A,{className:"h-4 w-4 text-blue-600"}):(0,j.jsx)("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-xs text-gray-600",children:s+1})}),(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,j.jsx)("h4",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),(0,j.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,j.jsx)(b.A,{className:"h-3 w-3 text-gray-400"}),(0,j.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(e.duration_minutes)," min"]}),M>.9&&C.id===e.id&&(0,j.jsx)(f.A,{className:"h-3 w-3 text-green-500"})]})]})]})},e.id))}),(0,j.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,j.jsx)("span",{className:"text-sm text-gray-600",children:"Progress"}),(0,j.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[Math.round((O()+(M>.9?1:0))/y.length*100),"%"]})]}),(0,j.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,j.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:(O()+(M>.9?1:0))/y.length*100+"%"}})})]})]})]})}):(0,j.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Lesson not found"}),(0,j.jsx)("button",{onClick:()=>p("/courses"),className:"text-blue-600 hover:text-blue-700",children:"Back to Courses"})]})})}}}]);
//# sourceMappingURL=917.9e9828f4.chunk.js.map